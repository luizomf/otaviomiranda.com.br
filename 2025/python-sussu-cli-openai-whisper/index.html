<!doctype html>
<html lang="pt-BR">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />

    <title>
      Transcreva √°udio com Python: Sussu CLI + OpenAI Whisper - Ot√°vio Miranda
    </title>
    <meta
      name="description"
      content="Aprenda a usar o Sussu, uma ferramenta de linha de comando feita em Python que utiliza o modelo Whisper da OpenAI para transcrever √°udios e v√≠deos de forma simples e eficiente."
    />

    <link rel="stylesheet" href="../../css/styles_2026.css" />

    <link rel="icon" type="image/webp" href="../../imgs/favicon-1.webp" />

    <!-- conex√£o antecipada -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />

    <!-- fonte -->
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@400;800&display=swap"
      rel="stylesheet"
    />
  </head>

  <body>
    <input
      aria-label="Tema Claro ou Escuro (Tempor√°rio)"
      title="Tema Claro ou Escuro (Tempor√°rio)"
      id="theme-mode"
      type="checkbox"
    />

    <main class="main">
      <aside class="nav">
        <a class="copyright-link" href="/">Ot√°vio Miranda</a>
        <a
          target="_blank"
          href="https://beacons.ai/otaviomiranda"
          rel="nofollow noopener noreferrer"
          >Contatos</a
        >
      </aside>

      <article class="article" id="content">
        <h1>sussu(rro): CLI educacional com OpenAI Whisper</h1>

        <p class="author">
          <span class="meta-date">
            <time datetime="2025-09-02">2 de setembro de 2025</time>
          </span>
          ¬∑
          <span class="meta-author">Luiz Ot√°vio Miranda</span>
        </p>

        <blockquote>
          <p>
            Ferramenta de linha de comando focada em educa√ß√£o e IA offline.
            Utiliza o poder do Whisper da OpenAI para transcrever √°udios e
            v√≠deos de forma simples e eficiente.
          </p>
        </blockquote>

        <p>Esses s√£o todos os links que menciono nos dois v√≠deos:</p>
        <ul>
          <li>
            <a
              href="https://www.otaviomiranda.com.br/2025/whisper-live-sera-que-deu-certo/"
              >(üö´ FAILED) whisper em tempo real via microfone</a
            >
          </li>
          <li>
            <a href="https://docs.python.org/3/library/logging.html"
              >logging ‚Äî Logging facility for Python</a
            >
          </li>
          <li>
            <a
              href="https://www.otaviomiranda.com.br/2025/python-sussu-cli-openai-whisper/"
              >sussu(rro): CLI educacional com OpenAI Whisper</a
            >
          </li>
          <li>
            <a href="https://github.com/openai/whisper">openai / whisper</a>
          </li>
        </ul>
        <h3>üé• Parte 1 ‚Äî CLI do Whisper:</h3>
        <ul>
          <li>
            <a href="https://youtu.be/y15070biffg"
              >Whisper OpenAI: Guia Completo de Transcri√ß√£o com Intelig√™ncia
              Artificial (v√≠deo e √°udio)</a
            >
          </li>
        </ul>
        <h3>üíª Parte 2 ‚Äî C√≥digo do <code>sussu</code> com Python + Whisper:</h3>
        <ul>
          <li>
            <a href="https://youtu.be/SAt7yuO8DX4"
              >Whisper com Python: transcri√ß√£o de √°udio com Intelig√™ncia
              Artificial no seu projeto</a
            >
          </li>
        </ul>
        <hr />
        <h2>Sobre o Whisper e a OpenAI</h2>
        <p>
          Estava curioso para saber se a OpenAI usa o Whisper em seus pr√≥prios
          produtos, ent√£o questionei o ChatGPT...
        </p>
        <blockquote>
          <p>
            <strong>Eu:</strong> A OpenAI usa o Whisper internamente em algum
            recurso que as pessoas consomem? <br /><strong>ChatGPT:</strong>
            Sim, a OpenAI usa o Whisper como base para recursos de transcri√ß√£o e
            compreens√£o de √°udio em produtos como o ChatGPT com entrada de voz.
            Ele tamb√©m √© utilizado em APIs que envolvem reconhecimento de fala,
            como a <code>speech-to-text</code> da OpenAI.
          </p>
        </blockquote>
        <hr />
        <h2>Sobre este documento:</h2>
        <p>
          Estou tentando manter este documento (<code>README.md</code>)
          sincronizado com o link abaixo. Caso n√£o encontre o que procura aqui,
          acesse:
        </p>
        <ul>
          <li>
            <a
              href="https://www.otaviomiranda.com.br/2025/python-sussu-cli-openai-whisper/"
              >Transcreva √°udio com Python: Sussu CLI + OpenAI Whisper</a
            >
          </li>
        </ul>
        <hr />
        <h2>Introdu√ß√£o geral</h2>
        <p>
          Ao rodar este projeto, uma das primeiras coisas que voc√™ vai querer
          fazer √© usar o comando <code>whisper</code> para fazer a transcri√ß√£o
          inicial de algum v√≠deo ou √°udio. Essa transcri√ß√£o √© um √≥timo jeito de
          ver na pr√°tica como o <strong>Whisper</strong> trabalha e o que
          esperar dos resultados.
        </p>
        <ul>
          <li>
            <a href="https://github.com/openai/whisper"
              >Reposit√≥rio oficial do <code>whisper</code></a
            >
          </li>
          <li>
            <a href="https://github.com/luizomf/sussu"
              >Reposit√≥rio do <code>sussu</code></a
            >
          </li>
        </ul>
        <p>
          Vamos come√ßar pela <strong>instala√ß√£o</strong> do projeto, isso j√°
          coloca os comandos <code>sussu</code> e
          <code>whisper</code> funcionando direto no seu terminal.
        </p>
        <hr />
        <h2>Instala√ß√£o do <code>sussu</code></h2>
        <p>
          Se voc√™ encontrar alguma dificuldade com o ambiente, recomendo meu
          tutorial completo:
        </p>
        <ul>
          <li>
            <a href="https://www.youtube.com/watch?v=HuAc85cLRx0"
              >Ambiente Python Moderno 2025: UV, Ruff, Pyright, pyproject.toml e
              VS Code</a
            >
          </li>
        </ul>
        <p>
          Este projeto utiliza o <strong>Python 3.11.9</strong> por quest√µes de
          compatibilidade com o <strong>Whisper</strong>. Evite alterar essa
          vers√£o se n√£o souber o que est√° fazendo, pois
          <strong>eu j√° testei tudo para voc√™</strong>.
        </p>
        <p>
          Al√©m disso, este projeto usa o
          <a href="https://docs.astral.sh/uv/"><code>uv</code></a> para o
          gerenciamento geral (pacotes, vers√£o do Python, etc.).
        </p>
        <p>Para instalar tudo, basta rodar o comando:</p>

        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#9399B2;font-style:italic"># Se ainda n√£o clonou o reposit√≥rio</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">git</span><span style="color:#A6E3A1"> clone</span><span style="color:#A6E3A1"> https://github.com/luizomf/sussu.git</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Acesse a pasta do projeto</span></span>
<span class="line"><span style="color:#F38BA8;font-style:italic">cd</span><span style="color:#A6E3A1"> sussu</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Sincronizando</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">uv</span><span style="color:#A6E3A1"> sync</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># √© s√≥ isso mesmo üòÖ</span></span></code></pre>

        <p><code>uv sync</code> √© suficiente para:</p>
        <ul>
          <li>Baixar e instalar o <code>python 3.11.9</code></li>
          <li>Criar o ambiente virtual em <code>.venv</code></li>
          <li>Instalar os pacotes necess√°rios</li>
          <li>Buildar o <code>whisper</code> e o <code>sussu</code></li>
        </ul>
        <hr />
        <h2><code>ffmpeg</code></h2>
        <p>
          Voc√™ tamb√©m precisar√° ter o
          <strong><code>ffmpeg</code></strong> instalado. Ele √© um software de
          c√≥digo aberto com v√°rias ferramentas e bibliotecas para trabalhar com
          arquivos multim√≠dia, especialmente √°udio e v√≠deo. Embora o
          <code>whisper</code> foque na transcri√ß√£o de √°udio, o
          <code>ffmpeg</code> √© quem permite que voc√™ transcreva seus v√≠deos
          diretamente, sem precisar convert√™-los para √°udio antes.
        </p>
        <p>
          Para instalar o <code>ffmpeg</code> no seu sistema, voc√™ pode usar um
          dos comandos abaixo. Eles foram retirados diretamente do
          <a href="https://github.com/openai/whisper"
            >reposit√≥rio oficial do <code>whisper</code></a
          >:
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#9399B2;font-style:italic"># No Ubuntu ou Debian</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">sudo</span><span style="color:#A6E3A1"> apt</span><span style="color:#A6E3A1"> update</span><span style="color:#9399B2"> &#x26;&#x26;</span><span style="color:#89B4FA;font-style:italic"> sudo</span><span style="color:#A6E3A1"> apt</span><span style="color:#A6E3A1"> install</span><span style="color:#A6E3A1"> ffmpeg</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># No Arch Linux</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">sudo</span><span style="color:#A6E3A1"> pacman</span><span style="color:#A6E3A1"> -S</span><span style="color:#A6E3A1"> ffmpeg</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># No macOS com Homebrew (https://brew.sh/)</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">brew</span><span style="color:#A6E3A1"> install</span><span style="color:#A6E3A1"> ffmpeg</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># No Windows com Chocolatey (https://chocolatey.org/)</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">choco</span><span style="color:#A6E3A1"> install</span><span style="color:#A6E3A1"> ffmpeg</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># No Windows usando Scoop (https://scoop.sh/)</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">scoop</span><span style="color:#A6E3A1"> install</span><span style="color:#A6E3A1"> ffmpeg</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Adicional: No Windows usando winget (https://winstall.app/apps/Gyan.FFmpeg)</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">winget</span><span style="color:#A6E3A1"> install</span><span style="color:#A6E3A1"> --id=Gyan.FFmpeg</span><span style="color:#A6E3A1"> -e</span></span></code></pre>
        <p>
          <strong>Observa√ß√£o:</strong> Dos comandos listados, os √∫nicos que
          testei e aprovei (‚úÖ) foram os para <strong>macOS</strong> e
          <strong>Ubuntu</strong>.
        </p>
        <hr />
        <h2>Rodando pela Primeira Vez</h2>
        <p>
          Para verificar se tudo foi instalado corretamente, voc√™ tem duas
          op√ß√µes: <strong>ativar o ambiente virtual</strong> ou usar o comando
          <strong><code>uv run</code></strong
          >. Sugiro que voc√™ teste com <code>whisper -h</code>. Esse comando
          deve exibir a ajuda completa do <code>whisper</code>, indicando que
          ele est√° funcionando. Veja os exemplos:
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#89B4FA;font-style:italic">uv</span><span style="color:#A6E3A1"> run</span><span style="color:#A6E3A1"> whisper</span><span style="color:#A6E3A1"> -h</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Ou, se voc√™ j√° ativou o ambiente virtual</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> -h</span></span></code></pre>
        <p>
          <strong>Observa√ß√£o:</strong> Editores de c√≥digo como
          <strong>VS Code</strong> ou <strong>Zed</strong> podem ativar o
          ambiente virtual automaticamente ao abrir um novo terminal, desde que
          estejam configurados corretamente. Se for o seu caso, basta fechar e
          abrir o terminal novamente para que as mudan√ßas fa√ßam efeito.
        </p>
        <hr />
        <h2>
          <code>whisper -h</code>: Entendendo Alguns Argumentos Importantes
        </h2>
        <p>
          Ao digitar <code>whisper -h</code> ou <code>whisper --help</code>,
          voc√™ pode se surpreender com a quantidade de argumentos dispon√≠veis.
          Mas n√£o se preocupe! Voc√™ n√£o precisa saber o que cada um deles faz.
          Na verdade, a maioria dos argumentos j√° vem com valores padr√£o que
          funcionam perfeitamente. No entanto, se voc√™ quiser personalizar um
          pouco o comportamento da ferramenta, vamos analisar alguns dos mais
          importantes.
        </p>
        <p>
          O <code>whisper</code> utiliza a biblioteca <code>argparse</code> do
          Python para gerar essa documenta√ß√£o de ajuda (<code>help</code>)
          completa e bem organizada. Se voc√™ tiver interesse em aprender mais
          sobre como criar interfaces de linha de comando profissionais com
          Python, confira meu v√≠deo:
        </p>
        <ul>
          <li>
            <a href="https://www.youtube.com/watch?v=Ad6934NXn4A"
              >Python e argparse: Do Zero a uma CLI Profissional (Projeto Real
              na Pr√°tica)</a
            >
          </li>
        </ul>
        <hr />
        <h3>Argumentos Essenciais do <code>whisper</code></h3>
        <p>
          Vamos come√ßar com os argumentos que voc√™ usar√° com mais frequ√™ncia:
        </p>
        <p>
          <strong><code>audio</code></strong
          >: Este √© o <strong>argumento posicional</strong> principal. Ele
          representa o caminho completo (localiza√ß√£o) do arquivo de √°udio ou
          v√≠deo que voc√™ quer transcrever.
        </p>
        <p><strong>Exemplo:</strong></p>

        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> /caminho/do/seu/arquivo.mp4</span></span></code></pre>

        <p>
          No exemplo acima, voc√™ notou que especificamos apenas o caminho do
          arquivo de v√≠deo. Nas pr√≥ximas se√ß√µes, vou detalhar as op√ß√µes que mais
          utilizo para personalizar a transcri√ß√£o.
        </p>
        <hr />

        <p>
          <strong><code>--model MODEL</code></strong
          >: Este argumento serve para
          <strong>definir qual modelo ser√° usado na transcri√ß√£o</strong> do seu
          √°udio ou v√≠deo. Ele √© opcional, e o valor padr√£o √© <code>turbo</code>.
          O modelo <code>turbo</code> √© excelente: r√°pido e multil√≠ngue, mas
          requer cerca de <strong>6GB de VRAM</strong> para rodar.
        </p>
        <p>
          Talvez voc√™ queira usar outros modelos que exigem mais ou menos
          recursos do seu hardware, ou que possuem mais ou menos par√¢metros
          (como <code>base</code>, <code>small</code>, <code>medium</code>,
          etc.).
        </p>
        <p>
          Aqui est√£o os modelos dispon√≠veis e seus requisitos aproximados de
          VRAM:
        </p>
        <ul>
          <li>
            <strong><code>tiny</code></strong
            >: 39M par√¢metros, <code>tiny.en</code> e <code>tiny</code>, VRAM ~1
            GB
          </li>
          <li>
            <strong><code>base</code></strong
            >: 74M par√¢metros, <code>base.en</code> e <code>base</code>, VRAM ~1
            GB
          </li>
          <li>
            <strong><code>small</code></strong
            >: 244M par√¢metros, <code>small.en</code> e <code>small</code>, VRAM
            ~2 GB
          </li>
          <li>
            <strong><code>medium</code></strong
            >: 769M par√¢metros, <code>medium.en</code> e <code>medium</code>,
            VRAM ~5 GB
          </li>
          <li>
            <strong><code>large</code></strong
            >: 1550M par√¢metros, <code>large</code>, <code>large-v2</code> e
            <code>large-v3</code>, VRAM ~10 GB
          </li>
          <li>
            <strong><code>turbo</code></strong
            >: 809M par√¢metros, <code>turbo</code>, VRAM ~6 GB
          </li>
        </ul>
        <p>
          <strong>VRAM</strong> √© um tipo de mem√≥ria RAM especializada que as
          placas de v√≠deo (GPUs) usam. Mas n√£o se preocupe se voc√™ n√£o tiver uma
          placa de v√≠deo dedicada! Se seu computador compartilha a RAM com a
          GPU, o que acontece em Macs com chips Apple Silicon (M1, M2, M3 e
          posteriores), por exemplo, voc√™ conseguir√° usar os modelos do Whisper
          normalmente.
        </p>
        <p>
          Nesses casos, o que realmente limita √© a
          <strong
            >quantidade total de mem√≥ria RAM dispon√≠vel no seu sistema</strong
          >. Por exemplo: se voc√™ tem apenas 8GB de RAM, o ideal √© testar os
          modelos <code>tiny</code>, <code>base</code> ou <code>small</code>.
        </p>
        <p>
          A partir do modelo <code>medium</code>, √© bem prov√°vel que voc√™
          perceba uma
          <strong>queda dr√°stica no desempenho geral da sua m√°quina</strong>, j√°
          que a mem√≥ria ser√° completamente consumida.
        </p>
        <p><strong>Exemplo:</strong></p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> /caminho/do/seu/arquivo.mp4</span><span style="color:#A6E3A1"> --model</span><span style="color:#A6E3A1"> large-v2</span></span></code></pre>
        <hr />
        <p>
          <strong><code>--device DEVICE</code></strong
          >: Este argumento √© para voc√™ que possui uma
          <strong>placa de v√≠deo NVIDIA com drivers CUDA</strong> e uma vers√£o
          compat√≠vel com o PyTorch. Se for o seu caso, vale a pena usar
          <code>--device cuda</code> para aproveitar o processamento da GPU.
          Caso contr√°rio, n√£o se preocupe em alterar esta op√ß√£o, o padr√£o √©
          <code>cpu</code> (processamento pela CPU) e funcionar√° perfeitamente.
        </p>
        <p><strong>Exemplo:</strong></p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> /caminho/do/seu/arquivo.mp4</span><span style="color:#A6E3A1"> --model</span><span style="color:#A6E3A1"> large-v2</span><span style="color:#A6E3A1"> --device</span><span style="color:#A6E3A1"> cpu</span></span></code></pre>
        <hr />
        <p>
          <strong><code>--output_dir</code> ou <code>-o</code></strong
          >: Define o
          <strong>caminho da pasta onde as transcri√ß√µes ser√£o salvas</strong>.
          Por padr√£o, os arquivos ser√£o salvos na raiz do projeto
          (<code>.</code>).
        </p>
        <hr />
        <p>
          <strong><code>--output_format</code> ou <code>-f</code></strong
          >: Permite que voc√™ escolha o
          <strong>formato da transcri√ß√£o ou legenda</strong> gerada. As op√ß√µes
          dispon√≠veis s√£o: <code>txt</code>, <code>vtt</code>, <code>srt</code>,
          <code>tsv</code>, <code>json</code> e <code>all</code> (que gera todos
          os formatos). O padr√£o √© <code>all</code>.
        </p>
        <hr />
        <p><strong>Exemplo:</strong></p>
        <p>
          O arquivo de sa√≠da ser√° <code>srt</code> (SubRip) na pasta indicada em
          <code>-o</code>. Essa pasta ser√° criada caso n√£o exista.
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> /caminho/do/seu/arquivo.mp4</span><span style="color:#A6E3A1"> --model</span><span style="color:#A6E3A1"> turbo</span><span style="color:#A6E3A1"> -o</span><span style="color:#A6E3A1"> caminho/da/pasta_de_saida</span><span style="color:#A6E3A1"> -f</span><span style="color:#A6E3A1"> srt</span></span></code></pre>
        <hr />
        <p>
          <strong><code>--task</code></strong
          >: Com este argumento, voc√™ pode escolher entre
          <strong>transcrever o √°udio</strong> no idioma original ou
          <strong>traduzir para o ingl√™s</strong>. As op√ß√µes s√£o
          <code>transcribe</code> (o padr√£o, que transcreve no idioma falado no
          √°udio) ou <code>translate</code> (que traduz o conte√∫do para o
          ingl√™s).
        </p>
        <p><strong>Exemplo:</strong></p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> /caminho/do/seu/arquivo.mp4</span><span style="color:#A6E3A1"> --model</span><span style="color:#A6E3A1"> turbo</span><span style="color:#A6E3A1"> --task</span><span style="color:#A6E3A1"> transcribe</span></span></code></pre>
        <hr />
        <p>
          <strong><code>--language</code></strong
          >: Este argumento permite que voc√™
          <strong>especifique o idioma falado no √°udio ou v√≠deo</strong>.
          Existem muitas op√ß√µes de idiomas dispon√≠veis. Se voc√™ n√£o informar
          esse argumento, o <code>whisper</code> √© inteligente o suficiente para
          detectar automaticamente o idioma do conte√∫do.
        </p>
        <hr />
        <p>Forma curta (language code):</p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#9399B2">[</span><span style="color:#A6E3A1">"af"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "am"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ar"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "as"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "az"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ba"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "be"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "bg"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "bn"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "bo"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "br"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "bs"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ca"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"cs"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "cy"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "da"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "de"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "el"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "en"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "es"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "et"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "eu"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "fa"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "fi"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "fo"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "fr"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"gl"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "gu"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ha"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "haw"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "he"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "hi"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "hr"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ht"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "hu"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "hy"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "id"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "is"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "it"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"ja"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "jw"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ka"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "kk"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "km"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "kn"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ko"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "la"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "lb"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ln"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "lo"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "lt"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "lv"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"mg"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "mi"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "mk"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ml"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "mn"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "mr"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ms"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "mt"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "my"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ne"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "nl"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "nn"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "no"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"oc"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "pa"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "pl"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ps"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "pt"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ro"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ru"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "sa"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "sd"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "si"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "sk"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "sl"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "sn"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"so"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "sq"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "sr"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "su"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "sv"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "sw"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ta"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "te"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "tg"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "th"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "tk"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "tl"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "tr"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"tt"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "uk"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "ur"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "uz"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "vi"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "yi"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "yo"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "yue"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ""</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "zh"</span><span style="color:#9399B2">]</span></span></code></pre>
        <ul>
          <li>Exemplo para portugu√™s do Brasil: <code>--language pt</code></li>
        </ul>
        <hr />
        <p>Forma longa (language name):</p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#9399B2">[</span><span style="color:#A6E3A1">"Afrikaans"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Albanian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Amharic"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Arabic"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Armenian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Assamese"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Azerbaijani"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Bashkir"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Basque"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Belarusian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Bengali"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Bosnian"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Breton"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Bulgarian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Burmese"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Cantonese"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Castilian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Catalan"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Chinese"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Croatian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Czech"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Danish"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Dutch"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "English"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Estonian"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Faroese"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Finnish"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Flemish"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "French"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Galician"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Georgian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "German"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Greek"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Gujarati"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Haitian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Haitian Creole"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Hausa"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Hawaiian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Hebrew"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Hindi"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Hungarian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Icelandic"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Indonesian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Italian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Japanese"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Javanese"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Kannada"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Kazakh"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Khmer"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Korean"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Lao"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Latin"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Latvian"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Letzeburgesch"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Lingala"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Lithuanian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Luxembourgish"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Macedonian"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Malagasy"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Malay"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Malayalam"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Maltese"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Mandarin"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Maori"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Marathi"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Moldavian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Moldovan"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Mongolian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Myanmar"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Nepali"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Norwegian"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Nynorsk"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Occitan"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Panjabi"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Pashto"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Persian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Polish"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Portuguese"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Punjabi"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Pushto"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Romanian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Russian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Sanskrit"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Serbian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Shona"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Sindhi"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Sinhala"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Sinhalese"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Slovak"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Slovenian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Somali"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Spanish"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Sundanese"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Swahili"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Swedish"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Tagalog"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Tajik"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Tamil"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Tatar"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Telugu"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Thai"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Tibetan"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Turkish"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1">"Turkmen"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Ukrainian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Urdu"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Uzbek"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">"Valencian"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Vietnamese"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Welsh"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Yiddish"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "Yoruba"</span><span style="color:#9399B2">]</span></span></code></pre>
        <ul>
          <li>
            Exemplo para portugu√™s do Brasil: <code>--language Portuguese</code>
          </li>
        </ul>
        <p>
          Se precisar de um dicion√°rio completo com todos os idiomas e seus
          c√≥digos, ele est√° dispon√≠vel em
          <code>whisper.tokenizer.LANGUAGES</code> dentro do c√≥digo do
          <code>whisper</code>.
        </p>
        <p><strong>Exemplo:</strong></p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#9399B2;font-style:italic"># Para o comando ficar menor, vou manter tudo padr√£o</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># model turbo (padr√£o)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># task transcribe (padr√£o)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># etc...</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Idioma falado no v√≠deo "Portugu√™s"</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> /caminho/do/seu/arquivo.mp4</span><span style="color:#A6E3A1"> --language</span><span style="color:#A6E3A1"> pt</span></span></code></pre>
        <hr />
        <p>
          <strong><code>--temperature</code>:</strong> controla a "criatividade"
          do modelo. Vai de <code>0.0</code> a <code>1.0</code>. Quanto mais
          alto, mais liberdade o modelo tem pra decidir os pr√≥ximos tokens. Esse
          par√¢metro interage com <code>--beam_size</code>,
          <code>--patience</code> e <code>--best_of</code>.
        </p>
        <hr />
        <p>
          <strong><code>--beam_size</code>:</strong> n√∫mero de hip√≥teses que o
          modelo mant√©m em paralelo. Pensa como se ele testasse v√°rios caminhos
          ao mesmo tempo e no fim escolhesse o melhor. O padr√£o √©
          <code>5</code> e
          <strong>s√≥ funciona se <code>--temperature == 0.0</code></strong
          >.
        </p>
        <hr />
        <p>
          <strong><code>--patience</code>:</strong> fator de toler√¢ncia que faz
          o modelo continuar explorando novas hip√≥teses mesmo depois de achar
          uma aceit√°vel. Requer <code>--temperature == 0.0</code> e
          <code>--beam_size &gt; 1</code>.
        </p>
        <hr />
        <p>
          <strong><code>--best_of</code>:</strong> n√∫mero de amostras diferentes
          geradas antes de escolher a melhor. Funciona apenas quando
          <code>--temperature &gt; 0.0</code>.
        </p>
        <hr />
        <p><strong>Cola r√°pida:</strong></p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#9399B2;font-style:italic"># - temperature > 0 ‚Üí usa sampling</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#   ‚úÖ --best_of 5 (5 amostras)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#   üî¥ --beam_size (ignorado)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#   üî¥ --patience (ignorado)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># </span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># </span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># - temperature == 0 ‚Üí usa beam search</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#   ‚úÖ --beam_size 5 (5 hip√≥teses)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#   ‚úÖ --patience 2 (2 x 5 = 10 hip√≥teses)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#   üî¥ --best_of (ignorado)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># </span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># - temperature == 0 ‚Üí greedy</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#   ‚úÖ --beam_size 1 (1 hip√≥tese)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#   üî¥ --patience (n√£o faz diferen√ßa)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#   üî¥ --best_of (ignorado)</span></span></code></pre>
        <p>
          <strong>Importante:</strong> Quanto maiores os valores de
          <code>--beam_size</code>, <code>--patience</code> e
          <code>--best_of</code>, mais lento e "indeciso" o modelo tende a
          ficar. Isso acontece porque ele precisa gerar mais hip√≥teses ou
          amostras e, em seguida, tomar uma decis√£o entre elas. Fa√ßa testes
          r√°pidos para confirmar esse comportamento.
        </p>
        <p><strong>Observa√ß√£o sincera:</strong></p>
        <p>
          Na pr√°tica, o modelo vai responder como foi treinado, independente do
          seu capricho nas configs. Trocar <code>temperature</code>,
          <code>beam_size</code>, <code>patience</code> e afins pode virar
          desperd√≠cio de tempo.
        </p>
        <p><strong>Recomenda√ß√£o direta:</strong> s√≥ mexa nessas op√ß√µes se:</p>
        <ul>
          <li>o modelo come√ßar a repetir palavras (loop)</li>
          <li>estiver errando demais em blocos grandes</li>
        </ul>
        <p>
          Se for s√≥ por causa de uma ou duas palavras... aceita e segue. Ou
          ent√£o faz igual eu:
          <strong
            >testa tudo por uma semana e conclui que o padr√£o j√° era bom</strong
          >
          üòÖ
        </p>
        <p><strong>Exemplo:</strong></p>
        <p>
          O arquivo de sa√≠da ser√° <code>srt</code> (SubRip) na pasta indicada em
          <code>-o</code>. Essa pasta ser√° criada caso n√£o exista.
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#9399B2;font-style:italic"># Greedy: Mais r√°pido, mas pode errar mais por considerar apenas uma hip√≥tese por vez.</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> /caminho/do/seu/arquivo.mp4</span><span style="color:#A6E3A1"> --temperature</span><span style="color:#FAB387"> 0.0</span><span style="color:#A6E3A1"> --beam_size</span><span style="color:#FAB387"> 1</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Beam Search: Utiliza 3 hip√≥teses em paralelo.</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># O 'patience' padr√£o √© 1.</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> /caminho/do/seu/arquivo.mp4</span><span style="color:#A6E3A1"> --temperature</span><span style="color:#FAB387"> 0.0</span><span style="color:#A6E3A1"> --beam_size</span><span style="color:#FAB387"> 3</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Sampling: Gera 5 amostras diferentes para escolher a melhor.</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> /caminho/do/seu/arquivo.mp4</span><span style="color:#A6E3A1"> --temperature</span><span style="color:#FAB387"> 0.7</span><span style="color:#A6E3A1"> --best_of</span><span style="color:#FAB387"> 5</span></span></code></pre>
        <hr />
        <p>
          <strong><code>--temperature_increment_on_fallback</code></strong
          >: Este argumento permite que voc√™
          <strong
            >aumente a temperatura do modelo em casos de falha na
            transcri√ß√£o</strong
          >. Se o modelo encontrar dificuldades na temperatura <code>0.0</code>,
          ele far√° um "fallback" e tentar√° com a temperatura incrementada. O
          valor tamb√©m varia de <code>0.0</code> a <code>1.0</code>. No entanto,
          <strong
            >cuidado: definir <code>0.0</code> para este argumento causar√° um
            erro <code>ZeroDivisionError: float division by zero</code></strong
          >
          (isso pode ser um pequeno "bugzinho" ü´£, mas, de fato, n√£o faria muito
          sentido usar zero aqui, j√° que o objetivo √© justamente
          <em>incrementar</em> a temperatura). O valor padr√£o √©
          <code>0.2</code>.
        </p>
        <hr />
        <p>
          <strong><code>--max_line_width</code></strong
          >: Define a
          <strong>quantidade m√°xima de caracteres por linha</strong> na sua
          legenda. O valor padr√£o √© <code>1000</code> (um limite bastante alto,
          codificado diretamente na classe <code>SubtitlesWriter</code> do
          <code>whisper</code>). Eu, particularmente, costumo usar
          <code>45</code> para uma melhor legibilidade.
          <strong>Importante:</strong> Se este argumento for utilizado, ele
          anula o <code>--max_words_per_line</code>.
          <strong>Requer <code>--word_timestamps True</code></strong
          >.
        </p>
        <hr />
        <p>
          <strong><code>--max_line_count</code></strong
          >: Controla a
          <strong>quantidade m√°xima de linhas por legenda</strong> (ou "bloco"
          de texto). Eu uso o valor <code>2</code>, mas, nos meus testes,
          percebi que isso for√ßa todas as legendas a terem sempre duas linhas.
          Para mim, n√£o √© um problema, mas vale a pena voc√™ testar para ver como
          se adapta ao seu caso.
          <strong>Requer <code>--word_timestamps True</code></strong
          >.
        </p>
        <hr />
        <p>
          <strong><code>--max_words_per_line</code></strong
          >: Determina a
          <strong>quantidade m√°xima de palavras por linha</strong> na legenda. O
          padr√£o tamb√©m √© um valor alto, <code>1000</code> (tamb√©m "hardcoded"
          na classe <code>SubtitlesWriter</code>). Embora eu n√£o costume us√°-lo,
          acredito que <code>5</code> palavras por linha pode resultar em uma
          leitura mais confort√°vel. <strong>Aten√ß√£o:</strong> Ser√° anulado por
          <code>--max_line_width</code> caso voc√™ use ambos no mesmo comando.
          <strong>Requer <code>--word_timestamps True</code></strong
          >.
        </p>
        <hr />
        <p>
          <strong><code>--highlight_words</code></strong
          >: Este √© o argumento respons√°vel por criar o
          <strong>efeito de "karaok√™"</strong> na sua transcri√ß√£o. Ele faz com
          que cada palavra falada seja sublinhada no momento exato em que √©
          pronunciada.
          <strong>Requer <code>--word_timestamps True</code></strong
          >.
        </p>
        <hr />
        <p>
          <strong><code>--word_timestamps</code></strong
          >: Este argumento √© a <strong>chave</strong> para ativar os recursos
          de sincroniza√ß√£o detalhada. Ao defini-lo como <code>True</code>, o
          modelo passar√° a gerar <strong>timestamps para cada palavra</strong>,
          em vez de apenas por blocos de frase. Isso pode, sim, aumentar
          consideravelmente o tempo de transcri√ß√£o, mas √© um requisito
          fundamental para que v√°rios outros argumentos (como os de formata√ß√£o
          de linha e destaque de palavras) funcionem. O valor padr√£o √©
          <code>False</code>.
        </p>
        <hr />
        <p><strong>Exemplo Completo de Transcri√ß√£o Detalhada</strong></p>
        <p>
          Veja um exemplo de como combinar v√°rios desses argumentos para obter
          uma transcri√ß√£o formatada e com destaque de palavras:
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#9399B2;font-style:italic"># A '\' (barra invertida no final da linha) √© usada apenas para indicar que</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># o comando continua na linha de baixo. Isso √© uma boa pr√°tica para evitar</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># que o comando fique muito longo na horizontal e melhora a legibilidade.</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> meu_video.mp4</span><span style="color:#F5C2E7"> \</span></span>
<span class="line"><span style="color:#A6E3A1">  --model</span><span style="color:#A6E3A1"> large-v2</span><span style="color:#F5C2E7"> \</span></span>
<span class="line"><span style="color:#A6E3A1">  --language</span><span style="color:#A6E3A1"> pt</span><span style="color:#F5C2E7"> \</span></span>
<span class="line"><span style="color:#A6E3A1">  --output_format</span><span style="color:#A6E3A1"> srt</span><span style="color:#F5C2E7"> \</span></span>
<span class="line"><span style="color:#A6E3A1">  --word_timestamps</span><span style="color:#A6E3A1"> True</span><span style="color:#F5C2E7"> \</span></span>
<span class="line"><span style="color:#A6E3A1">  --highlight_words</span><span style="color:#A6E3A1"> True</span><span style="color:#F5C2E7"> \</span></span>
<span class="line"><span style="color:#A6E3A1">  --max_line_width</span><span style="color:#FAB387"> 45</span><span style="color:#F5C2E7"> \</span></span>
<span class="line"><span style="color:#A6E3A1">  --max_line_count</span><span style="color:#FAB387"> 2</span></span></code></pre>
        <hr />
        <p>
          <strong><code>--initial_prompt</code></strong
          >:
        </p>
        <p>
          Este √© um texto opcional que serve como um
          <strong
            >"empurr√£ozinho" para o modelo antes que ele comece a
            transcrever</strong
          >. Funciona como uma dica de estilo ou contexto. No entanto, √©
          importante notar que ele s√≥ influencia a
          <strong>primeira "janela" do √°udio</strong> (que por padr√£o tem 30
          segundos).
        </p>
        <p><strong>Exemplo Pr√°tico:</strong></p>
        <p>
          Se o seu v√≠deo √© sobre programa√ß√£o, especificamente Python, voc√™ pode
          passar um prompt como este:
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#89B4FA;font-style:italic">--initial_prompt</span><span style="color:#A6E3A1"> "v√≠deo de uma explica√ß√£o sobre programa√ß√£o com destaque para bibliotecas do Python"</span></span></code></pre>
        <p>
          Isso pode ajudar o modelo a reconhecer e transcrever termos t√©cnicos
          de programa√ß√£o e Python com mais precis√£o. Mas, como dito, n√£o espere
          milagres para o v√≠deo inteiro; essa influ√™ncia √© apenas um toque
          inicial. Para as janelas seguintes, o modelo pode usar o texto
          transcrito anteriormente, se a op√ß√£o
          <code>--condition_on_previous_text</code> estiver como
          <code>True</code> (que √© o padr√£o).
        </p>
        <p><strong>Analogia para Entender Melhor:</strong></p>
        <blockquote>
          <p>
            Imagine que √© como dizer para um cantor, antes de ele subir no
            palco: <br />"Tem 300 mil pessoas te esperando, detona l√°!"
            <br />Ele vai subir j√° no clima certo, mas o resto da performance
            depender√° do show em si. <br />Da mesma forma, o modelo continua a
            transcri√ß√£o com base no que "ouviu" e transcreveu depois do prompt
            inicial.
          </p>
        </blockquote>
        <p>
          <strong>Cuidados com o <code>--initial_prompt</code></strong
          >:
        </p>
        <p>
          O <code>--initial_prompt</code> pode afetar significativamente a forma
          como o modelo do <code>whisper</code> opera. Em alguns casos, ele pode
          levar √† gera√ß√£o de legendas excessivamente longas ou at√© mesmo fazer o
          modelo entrar em <strong>loops de repeti√ß√£o</strong>.
        </p>
        <p>
          <strong>Recomenda√ß√£o:</strong> Antes de aplicar um prompt em um v√≠deo
          completo, fa√ßa <strong>testes r√°pidos em um trecho menor</strong> do
          seu v√≠deo para observar o resultado. Isso evita surpresas e economiza
          tempo de processamento.
        </p>
        <p>
          Para cortar facilmente um peda√ßo do seu v√≠deo para testes, voc√™ pode
          usar o <code>ffmpeg</code> com o seguinte comando:
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#9399B2;font-style:italic"># Com ffmpeg</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">ffmpeg</span><span style="color:#A6E3A1"> -i</span><span style="color:#A6E3A1"> entrada.mp4</span><span style="color:#A6E3A1"> -c:v</span><span style="color:#A6E3A1"> copy</span><span style="color:#A6E3A1"> -c:a</span><span style="color:#A6E3A1"> copy</span><span style="color:#A6E3A1"> -ss</span><span style="color:#A6E3A1"> 00:05:00.000</span><span style="color:#A6E3A1"> -to</span><span style="color:#A6E3A1"> 00:10:00.000</span><span style="color:#A6E3A1"> saida.mp4</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Tamb√©m d√° pra usar --clip_timestamps start, end, start, end... (em segundos)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># O argumento --clip_timestamps √© detalhado mais abaixo nesse texto</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># No comando abaixo ele transcreve de 1min at√© 2min (nada mais)</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> meu_video.mp4</span><span style="color:#A6E3A1"> --clip_timestamps</span><span style="color:#A6E3A1"> 60,120</span></span></code></pre>
        <p>
          <strong>Entendendo o Comando <code>ffmpeg</code>:</strong>
        </p>
        <ul>
          <li>
            <code>-i entrada.mp4</code>: Define o arquivo de v√≠deo de entrada (o
            seu v√≠deo original).
          </li>
          <li>
            <code>-c:v copy</code>: Copia o codec de v√≠deo do arquivo original,
            sem recodificar. Isso torna o processo muito mais r√°pido!
          </li>
          <li>
            <code>-c:a copy</code>: Copia o codec de √°udio do arquivo original,
            tamb√©m sem recodificar.
          </li>
          <li>
            <code>-ss 00:05:00.000</code>: Especifica o ponto de in√≠cio do corte
            (neste exemplo, 5 minutos e 0 segundos do v√≠deo original).
          </li>
          <li>
            <code>-to 00:10:00.000</code>: Define o ponto final do corte (neste
            exemplo, 10 minutos e 0 segundos do v√≠deo original).
          </li>
        </ul>
        <p>
          Este comando ir√° gerar um novo arquivo de v√≠deo
          (<code>saida.mp4</code>) contendo apenas o segmento entre 00:05:00 e
          00:10:00 do v√≠deo original. Essa t√©cnica √© extremamente √∫til,
          especialmente para v√≠deos mais longos (como os meus de 30+ minutos),
          pois permite testar configura√ß√µes espec√≠ficas em um peda√ßo pequeno sem
          ter que processar o v√≠deo inteiro.
        </p>
        <hr />
        <p>
          <strong><code>--condition_on_previous_text</code></strong
          >:
        </p>
        <p>
          Este argumento crucial define se
          <strong
            >o texto que j√° foi transcrito ser√° usado como contexto</strong
          >
          para ajudar a transcrever a pr√≥xima "janela" do √°udio.
        </p>
        <ul>
          <li>
            <code>True</code> (padr√£o): √â a configura√ß√£o ideal para a maioria
            dos casos. Ela ajuda a manter a
            <strong>fluidez e a consist√™ncia</strong> do texto, garantindo uma
            boa coes√£o entre os blocos da transcri√ß√£o.
          </li>
          <li>
            <code>False</code>: Desativa o uso do contexto anterior. Isso pode
            ser √∫til para <strong>evitar "loops de erro"</strong>, onde o modelo
            fica repetindo frases ou palavras indefinidamente.
          </li>
        </ul>
        <blockquote>
          <p>
            <em>Exemplo de Uso:</em> <br />Se a transcri√ß√£o come√ßar a errar e
            ficar repetindo, por exemplo,
            <code>"Ol√°, pessoal, hoje vamos falar sobre..."</code> em loop,
            desativar este argumento
            (<code>--condition_on_previous_text=False</code>) pode quebrar esse
            ciclo vicioso.
          </p>
        </blockquote>
        <hr />
        <p><strong>Recomenda√ß√µes Gerais para Contexto</strong></p>
        <p>Para otimizar suas transcri√ß√µes, considere as seguintes dicas:</p>
        <ul>
          <li>
            Para v√≠deos <strong>bem gravados</strong>, com
            <strong>√°udio limpo</strong> e
            <strong>sem erros ou repeti√ß√µes evidentes</strong>, mantenha o
            padr√£o: <code>--condition_on_previous_text=True</code>.
          </li>
          <li>
            Se o modelo come√ßar a <strong>repetir frases ou palavras</strong> de
            forma indesejada, experimente mudar para
            <code>--condition_on_previous_text=False</code>.
          </li>
          <li>
            O <code>--initial_prompt</code> pode ajudar
            <strong>somente no in√≠cio</strong> da transcri√ß√£o. N√£o espere que
            ele resolva problemas de consist√™ncia para o v√≠deo inteiro, mas pode
            ser √∫til para guiar o modelo em termos espec√≠ficos.
          </li>
        </ul>
        <hr />
        <h3>Par√¢metros que n√£o usei (ou quase n√£o usei ü´£):</h3>
        <p>
          Esses par√¢metros a√≠ de baixo
          <strong>eu n√£o testei quase nada</strong> (apenas alguns). S√≥ li a
          documenta√ß√£o, pesquei uma ideia geral e traduzi pra voc√™ n√£o precisar
          sofrer. Se quiser fu√ßar, fuce, mas vai por sua conta e risco. Pode ser
          que melhore algo, pode ser que n√£o mude nada. Vai depender do √°udio,
          da fase da lua e do humor do modelo üòÖ.
        </p>
        <p>
          Se eu come√ßar a usar alguma dessas op√ß√µes nas minhas transcri√ß√µes,
          prometo que volto aqui e atualizo esse trecho. Alguns deles eu cheguei
          a testar de forma supercifical (explico nos argumentos).
        </p>
        <hr />
        <p>
          <strong><code>--length_penalty</code></strong>
        </p>
        <p>
          Controla a penaliza√ß√£o para <em>sequ√™ncias longas</em>. Valor t√≠pico:
          entre <code>0.6</code> e <code>1.0</code>. Se voc√™ notar que a
          transcri√ß√£o t√° muito curta ou longa, pode brincar com isso. Eu n√£o
          toquei neste argumento.
        </p>
        <hr />
        <p>
          <strong><code>--suppress_tokens</code></strong>
        </p>
        <p>
          Permite suprimir tokens pelo ID. O valor <code>-1</code> (padr√£o) j√°
          suprime s√≠mbolos esquisitos e s√≥ mant√©m pontua√ß√µes comuns. Deixa
          assim, a menos que voc√™ saiba o que est√° fazendo.
        </p>
        <p>Exemplo:</p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#9399B2;font-style:italic"># Isso aqui vai cortar algumas coisas √∫teis (s√≥ exemplo).</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Seu texto n√£o ter√°: 'Ol√°', 'pessoal', ',', 'este', '√©', 'meu', 'texto', '.'</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Obs: texto sem ponto e v√≠rgula fica horr√≠vel</span></span>
<span class="line"><span style="color:#89B4FA;font-style:italic">whisper</span><span style="color:#A6E3A1"> /caminho/do/seu/arquivo.mp4</span><span style="color:#F5C2E7"> \</span></span>
<span class="line"><span style="color:#A6E3A1">    --model</span><span style="color:#A6E3A1"> turbo</span><span style="color:#F5C2E7"> \</span></span>
<span class="line"><span style="color:#A6E3A1">    --language</span><span style="color:#A6E3A1"> pt</span><span style="color:#F5C2E7"> \</span></span>
<span class="line"><span style="color:#A6E3A1">    --suppress_tokens=38056,842,24811,11,4065,1136,9230,35503,13</span></span></code></pre>
        <p><em>Quer saber o ID de um token espec√≠fico?</em></p>
        <p>
          Seguinte, se voc√™ que descobrir algum token para suprimir ou para
          qualquer outra coisa, veja um exemplo:
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#94E2D5">>>></span><span style="color:#CBA6F7"> from</span><span style="color:#CDD6F4"> whisper</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">tokenizer </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> get_tokenizer</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># get_tokenizer -> multilingual, num_languages=99, language='pt', task='transcribe'</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#                  True,         99                Qual idioma    Qual task</span></span>
<span class="line"><span style="color:#94E2D5">>>></span><span style="color:#CDD6F4"> tokenizer </span><span style="color:#94E2D5">=</span><span style="color:#89B4FA"> get_tokenizer</span><span style="color:#9399B2">(</span><span style="color:#FAB387">True</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> num_languages</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">99</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> language</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">'pt'</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> task</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">'transcribe'</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># tokenizer.encode voc√™ passa o 'valor' e recebe os tokens List[int]</span></span>
<span class="line"><span style="color:#94E2D5">>>></span><span style="color:#CDD6F4"> tokenizer</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">encode</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">'Ol√° pessoal, este √© meu texto.'</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#9399B2">[</span><span style="color:#FAB387">38056</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 842</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 24811</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 11</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 4065</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 1136</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 9230</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 35503</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 13</span><span style="color:#9399B2">]</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># tokenizer.decode voc√™ passa os tokens List[int] e recebe o 'valor'</span></span>
<span class="line"><span style="color:#94E2D5">>>></span><span style="color:#CDD6F4"> tokenizer</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">decode</span><span style="color:#9399B2">([</span><span style="color:#FAB387">38056</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 842</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 24811</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 11</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 4065</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 1136</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 9230</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 35503</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 13</span><span style="color:#9399B2">])</span></span>
<span class="line"><span style="color:#A6E3A1">'Ol√° pessoal, este √© meu texto.'</span></span>
<span class="line"><span style="color:#94E2D5">>>></span></span></code></pre>
        <hr />
        <p>
          <strong><code>--fp16</code></strong>
        </p>
        <p>Usa precis√£o <em>float16</em> para acelerar em GPU.</p>
        <p>
          No Mac M1, por exemplo, eu sempre uso <code>--fp16 False</code>, assim
          ele n√£o fica mostrando warning de que trocou pra <em>float32</em>.
          Essa troca acontece automaticamente se o seu hardware
          <strong>n√£o</strong> suportar <em>float16</em>, ent√£o:
        </p>
        <ul>
          <li>
            <strong>Se suportar:</strong> passa direto com <em>float16</em>.
          </li>
          <li>
            <strong>Se n√£o suportar:</strong> ele mostra um aviso e troca para
            <em>float32</em> sozinho.
          </li>
        </ul>
        <p>Exemplo do warning:</p>
        <pre><code>FP16 is not supported on CPU; using FP32 instead
</code></pre>
        <hr />
        <p>
          <strong><code>--compression_ratio_threshold</code></strong>
        </p>
        <p>
          Se a raz√£o de compress√£o (gzip) do texto for muito alta, ele assume
          que houve erro (textos muito repetitivos). Valor padr√£o √©
          <code>2.4</code>. √ötil pra detectar <em>loop de repeti√ß√£o</em>.
        </p>
        <p><strong>Como funciona a ideia:</strong></p>
        <p>
          O Whisper pega o texto, compacta com gzip e compara o
          <strong>tamanho original</strong> com o
          <strong>tamanho compactado</strong> para calcular a
          <strong>raz√£o de compress√£o</strong>. Textos repetitivos geram
          compress√µes mais eficientes, ou seja,
          <strong>raz√£o mais alta</strong>.
        </p>
        <ul>
          <li>
            <code>"Ol√°, ol√°, ol√°, ol√°, ol√°..."</code> ‚Üí compacta muito ‚Üí
            <strong>alta raz√£o</strong>
          </li>
          <li>
            <code>"O rato roeu a roupa do rei de Roma."</code> ‚Üí mais
            diversidade ‚Üí <strong>menor raz√£o</strong>
          </li>
        </ul>
        <p>
          Se a raz√£o ultrapassar o limite definido (padr√£o: <code>2.4</code>), o
          Whisper <strong>descarta o trecho</strong> por consider√°-lo
          problem√°tico (repetitivo, bugado etc).
        </p>
        <p>
          Se sua transcri√ß√£o estiver falhando <strong>sem motivo claro</strong>,
          esse filtro pode ser o culpado. Teste com
          <code>--compression_ratio_threshold 0</code> e veja se melhora.
        </p>
        <hr />
        <p>
          <strong><code>--logprob_threshold</code></strong>
        </p>
        <p>
          Se a m√©dia do logaritmo da probabilidade (logprob) dos tokens estiver
          abaixo disso, ele trata como erro. Padr√£o: <code>-1.0</code>. Voc√™
          consegue ver <code>avg_logprob</code> (m√©dia do logaritmo da
          probabilidade) das frases transcritas pelo Whisper no arquivo
          <code>.json</code> final gerado. Este arquivo cont√©m algo similar a
          isso:
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#9399B2">{</span></span>
<span class="line"><span style="color:#9399B2">  "</span><span style="color:#89B4FA">id</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 102</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">  "</span><span style="color:#89B4FA">seek</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 27632</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">  "</span><span style="color:#89B4FA">start</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 293.8</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">  "</span><span style="color:#89B4FA">end</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 294.66</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">  "</span><span style="color:#89B4FA">text</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#A6E3A1"> " primeiro os imports"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">  "</span><span style="color:#89B4FA">tokens</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#9399B2"> [</span><span style="color:#FAB387">51240</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 18314</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 3003</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 41596</span><span style="color:#9399B2">,</span><span style="color:#FAB387"> 51283</span><span style="color:#9399B2">],</span></span>
<span class="line"><span style="color:#9399B2">  "</span><span style="color:#89B4FA">temperature</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 0.0</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">  "</span><span style="color:#89B4FA">avg_logprob</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> -0.08265516709308235</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">  "</span><span style="color:#89B4FA">compression_ratio</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 1.7523364485981308</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">  "</span><span style="color:#89B4FA">no_speech_prob</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 1.1688144375965326e-11</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">  "</span><span style="color:#89B4FA">words</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#9399B2"> [</span></span>
<span class="line"><span style="color:#9399B2">    {</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">word</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#A6E3A1"> " primeiro"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">start</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 293.8</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">end</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 294.06</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">probability</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 0.7435079216957092</span></span>
<span class="line"><span style="color:#9399B2">    },</span></span>
<span class="line"><span style="color:#9399B2">    {</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">word</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#A6E3A1"> " os"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">start</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 294.06</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">end</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 294.24</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">probability</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 0.9965941309928894</span></span>
<span class="line"><span style="color:#9399B2">    },</span></span>
<span class="line"><span style="color:#9399B2">    {</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">word</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#A6E3A1"> " imports"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">start</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 294.24</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">end</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 294.66</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">      "</span><span style="color:#89B4FA">probability</span><span style="color:#9399B2">"</span><span style="color:#9399B2">:</span><span style="color:#FAB387"> 0.990346372127533</span></span>
<span class="line"><span style="color:#9399B2">    }</span></span>
<span class="line"><span style="color:#9399B2">  ]</span></span>
<span class="line"><span style="color:#9399B2">}</span></span></code></pre>
        <p>
          Aqui <code>avg_logprob</code> √© <code>-0.08265516709308235</code>.
          Quanto mais pr√≥ximo de <code>0</code>, mais confiante est√° o modelo.
        </p>
        <p>
          Suponha que o modelo est√° descartando coisas na transcri√ß√£o. Voc√™
          poderia testar <code>--logprob_threshold=-2.0</code> ou at√©
          <code>--logprob_threshold=-1000</code> (n√£o descarta nada).
        </p>
        <p>
          Isso pode gerar muito ru√≠do aleat√≥rio na transcri√ß√£o, mas pode fazer
          ele detectar o que voc√™ quer.
        </p>
        <p>
          O contr√°rio tamb√©m √© verdadeiro. Se usar
          <code>--logprob_threshold=-0.1</code> (por exemplo), o modelo vai
          pegar praticamente s√≥ o que tem certeza absoluta que t√° certo. Isso
          n√£o √© uma coisa boa ou ruim, depende do contexto e do seu objetivo. Na
          d√∫vida, manter o padr√£o costuma ser uma escolha segura.
        </p>
        <p>
          Quanto mais rigoroso, mais lento, porque ele vai tentar gerar v√°rias
          hip√≥teses at√© alcan√ßar esse n√≠vel de confian√ßa. No fim das contas, ele
          vai te entregar um texto de qualquer jeito, mas pode demorar bem mais
          e talvez nem seja t√£o diferente assim.
        </p>
        <hr />
        <p>
          <strong><code>--no_speech_threshold</code></strong>
        </p>
        <p>
          Se o modelo acredita que √© sil√™ncio (probabilidade alta de
          <code>&lt;|nospeech|&gt;</code>) <strong>e</strong> a decodifica√ß√£o
          falha (<code>logprob_threshold</code>), ele descarta o trecho como
          sendo sil√™ncio. Isso ajuda a cortar "respiros vazios" da transcri√ß√£o.
        </p>
        <p>
          Essa funcionalidade me encanta, e tenho planos futuros pra ela. Quem
          sabe a gente n√£o volta a falar disso mais pra frente?
        </p>
        <hr />
        <p>
          <strong><code>--prepend_punctuations</code></strong> (com
          <code>--word_timestamps True</code>):
        </p>
        <p>
          Este argumento controla quais caracteres de pontua√ß√£o que aparecem
          <strong>antes</strong> de uma palavra devem ser "colados" √† palavra
          seguinte, em vez de serem tratados como um token separado.
        </p>
        <ul>
          <li>
            <strong>Padr√£o</strong>: <code>\"\'‚Äú¬ø([{-</code> (inclui aspas,
            par√™nteses, etc.) e requer <code>--word_timestamps True</code>.
          </li>
        </ul>
        <p>
          Em teoria, se o modelo gerasse, por exemplo, os tokens <code>(</code>,
          <code>arg</code>, <code>ument</code>, <code>os</code>,
          <code>)</code> separadamente (tipo:
          <code>[7, 33544, 2206, 329, 8]</code> que formariam
          <code>(argumentos)</code>), o <code>(</code> e o
          <code>arg</code> seriam unidos para formar <code>(arg</code>.
        </p>
        <blockquote>
          <p>
            <strong>Observa√ß√£o Importante</strong>: eu testei o
            <code>whisper</code> com os idiomas <code>Portuguese</code> e
            <code>English</code> (90% em <code>Portuguese</code>, que √© meu caso
            de uso). Em nenhuma das legendas que gerei houve qualquer caso onde
            a pontua√ß√£o viesse antes de alguma palavra. Na pr√°tica, eu realmente
            n√£o usei este par√¢metro.
          </p>
        </blockquote>
        <hr />
        <p>
          <strong><code>--append_punctuations</code></strong> (com
          <code>--word_timestamps True</code>):
        </p>
        <p>
          Este argumento controla quais caracteres de pontua√ß√£o que aparecem
          <strong>depois</strong> de uma palavra devem ser "colados" √† palavra
          anterior.
        </p>
        <ul>
          <li>
            <strong>Padr√£o</strong>:
            <code>\"\'.„ÄÇ,Ôºå!ÔºÅ?Ôºü:Ôºö‚Äù)]}„ÄÅ</code> (inclui aspas, pontos,
            v√≠rgulas, interroga√ß√µes, etc.) e requer
            <code>--word_timestamps True</code>.
          </li>
        </ul>
        <p>
          Por exemplo, se os tokens gerados forem <code>Ok</code> e
          <code>?</code> separadamente, e o <code>?</code> estiver inclu√≠do
          nesta lista (o que j√° est√° por padr√£o), eles ser√£o unidos para formar
          <code>Ok?</code>.
        </p>
        <p>
          <strong>Dica Pr√°tica</strong>: Esses argumentos de pontua√ß√£o s√≥ far√£o
          uma diferen√ßa percept√≠vel se voc√™ precisar que o ponto ou outro
          s√≠mbolo tenha um <code>timestamp</code> <em>exatamente</em> separado
          da palavra, o que √© um caso de uso bastante espec√≠fico. Na maioria das
          situa√ß√µes, o padr√£o do <code>whisper</code> j√° √© bastante robusto. Do
          contr√°rio, e para simplificar, mantenha os valores padr√£o.
        </p>
        <hr />
        <h3>Outros √∫teis</h3>
        <p>
          <strong><code>--threads</code></strong>
        </p>
        <p>
          Define o n√∫mero de <em>threads</em> que o modelo vai usar na CPU.
          Exemplo: <code>--threads 4</code>. Se n√£o passar nada, ele usa o
          padr√£o da Torch (geralmente via MKL ou OMP).
        </p>
        <p>
          Nos meus testes (Mac M1), usei <code>1, 4, 10, 100, 1000</code>. O
          resultado? Ele s√≥ criou mais <em>threads</em> e usou mais CPU,
          <strong
            >mas a velocidade de transcri√ß√£o n√£o mudou absolutamente
            nada</strong
          >.
        </p>
        <p>
          Claro, meus testes foram superficiais. Pode ser que em outro sistema,
          com outra CPU (ou invocando Cthulhu no terminal), voc√™ veja alguma
          diferen√ßa. Eu? S√≥ vi o cooler suando.
        </p>
        <hr />
        <p>
          <strong><code>--clip_timestamps</code></strong>
        </p>
        <p>
          Permite transcrever ou traduzir apenas trechos espec√≠ficos do √°udio ou
          v√≠deo. Voc√™ passa os intervalos como pares <code>start,end</code> (em
          segundos). Pode usar v√°rios.
        </p>
        <p><strong>Exemplos:</strong></p>
        <ul>
          <li>
            <code>--clip_timestamps 10,30</code> ‚Üí transcreve de 10s at√© 30s
          </li>
          <li><code>--clip_timestamps 60,120</code> ‚Üí de 1min at√© 2min</li>
          <li>
            <code>--clip_timestamps 10,30,60,120</code> ‚Üí dois trechos: 10s‚Äì30s
            e 1min‚Äì2min
          </li>
          <li>
            ‚ö†Ô∏è <code>--clip_timestamps 270</code> ‚Üí de 4min30s at√© o final
          </li>
          <li>
            ‚ö†Ô∏è <code>--clip_timestamps 60,120,0</code> ‚Üí transcreve de 1min‚Äì2min
            <strong>e depois recome√ßa do zero at√© o fim</strong>
          </li>
        </ul>
        <p><strong>Aten√ß√£o:</strong></p>
        <p>
          Esse √∫ltimo exemplo (<code>60,120,0</code>) parece um caso n√£o
          previsto.
        </p>
        <p>
          O <code>0</code> vem depois de <code>120</code>, mas n√£o forma um par
          <code>start,end</code>.
        </p>
        <p>
          Nos testes, isso gerou um comportamento curioso: o modelo transcreveu
          normalmente de 1min at√© 2min,
          <strong>e depois do in√≠cio at√© o final</strong>.
        </p>
        <p>
          Mesmo assim, o VLC interpretou direitinho. Ele realinhou os blocos e
          ignorou os duplicados, mostrando s√≥ o que fazia sentido cronol√≥gico
          (<strong>aparentemente cortando o primeiro minuto</strong>).
        </p>
        <hr />
        <p>
          <strong><code>--hallucination_silence_threshold</code></strong>
        </p>
        <p>Funciona junto com <code>--word_timestamps True</code>.</p>
        <p>
          Ele tenta detectar trechos de sil√™ncio longos que o modelo pode ter
          "alucinado" (inventado texto).
        </p>
        <p>
          Se voc√™ passar <code>--hallucination_silence_threshold 1.5</code>, ele
          vai
          <strong
            >ignorar sil√™ncios maiores que 1.5s que geraram texto
            suspeito</strong
          >. N√£o toquei nesse argumento.
        </p>
        <hr />
        <h2>Usando o Whisper via c√≥digo</h2>
        <p>
          Para usar o <code>whisper</code> via c√≥digo, √© bem simples. Como
          informado no reposit√≥rio deles, basta usar o seguinte para uso normal
          do whisper.
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> whisper</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CDD6F4">model </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> whisper</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">load_model</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">"turbo"</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">result </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> model</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">transcribe</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">"audio.mp3"</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#FAB387;font-style:italic">print</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">result</span><span style="color:#9399B2">[</span><span style="color:#A6E3A1">"</span><span style="color:#A6E3A1;font-style:italic">text</span><span style="color:#A6E3A1">"</span><span style="color:#9399B2">])</span></span></code></pre>
        <p>Para um acesso de mais baixo n√≠vel:</p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> whisper</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CDD6F4">model </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> whisper</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">load_model</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">"turbo"</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># load audio and pad/trim it to fit 30 seconds</span></span>
<span class="line"><span style="color:#CDD6F4">audio </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> whisper</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">load_audio</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">"audio.mp3"</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">audio </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> whisper</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">pad_or_trim</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">audio</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># make log-Mel spectrogram and move to the same device as the model</span></span>
<span class="line"><span style="color:#CDD6F4">mel </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> whisper</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">log_mel_spectrogram</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">audio</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> n_mels</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">model</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">dims</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">n_mels</span><span style="color:#9399B2">).</span><span style="color:#89B4FA">to</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">model</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">device</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># detect the spoken language</span></span>
<span class="line"><span style="color:#CDD6F4">_</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> probs </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> model</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">detect_language</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">mel</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#FAB387;font-style:italic">print</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1;font-style:italic">f</span><span style="color:#A6E3A1">"Detected language: </span><span style="color:#F5C2E7">{</span><span style="color:#FAB387;font-style:italic">max</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">probs</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> key</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">probs</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">get</span><span style="color:#9399B2">)</span><span style="color:#F5C2E7">}</span><span style="color:#A6E3A1">"</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># decode the audio</span></span>
<span class="line"><span style="color:#CDD6F4">options </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> whisper</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">DecodingOptions</span><span style="color:#9399B2">()</span></span>
<span class="line"><span style="color:#CDD6F4">result </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> whisper</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">decode</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">model</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> mel</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> options</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># print the recognized text</span></span>
<span class="line"><span style="color:#FAB387;font-style:italic">print</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">result</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">text</span><span style="color:#9399B2">)</span></span></code></pre>
        <h3>E como eu fiz meu c√≥digo?</h3>
        <p>
          Eu fiz o c√≥digo de uma forma que eu continuasse usando todos os
          par√¢metros do <code>whisper</code>, por√©m, adicionando minha pr√≥pria
          l√≥gica.
        </p>
        <p>
          Basicamente eu simulo que os argumentos est√£o sendo enviados para mim
          com <code>sys.argv</code> do Python. No Diagrama abaixo eu mostro o
          processo do "terminal" at√© chegar ao <code>argparse</code>, e do lado
          direito, como montei meu c√≥digo tamb√©m chamando o argparse.
        </p>
        <p>
          <a
            href="images/diagrama.webp"
            target="_blank"
            rel="noopener noreferrer"
          >
            <img
              src="images/diagrama.webp"
              alt="Diagrama exibindo como usei o `sys.argv` para simular o terminal no meu c√≥digo"
            />
            <em
              >Diagrama exibindo como usei o `sys.argv` para simular o terminal
              no meu c√≥digo</em
            >
          </a>
        </p>

        <p>
          Veja o c√≥digo a seguir. S√≥ para constar, tem um logger em outro m√≥dulo
          com o seguinte c√≥digo.
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> logging</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">from</span><span style="color:#CDD6F4"> rich</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">logging </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> RichHandler</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CDD6F4">logging</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">basicConfig</span><span style="color:#9399B2">(</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">    level</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"CRITICAL"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">    format</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"</span><span style="color:#F5C2E7">%(message)s</span><span style="color:#A6E3A1">"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">    datefmt</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"[%H:%M]"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">    handlers</span><span style="color:#94E2D5">=</span><span style="color:#9399B2">[</span></span>
<span class="line"><span style="color:#89B4FA">        RichHandler</span><span style="color:#9399B2">(</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">            show_time</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">            show_level</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">            rich_tracebacks</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">            omit_repeated_times</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">False</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">            markup</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">False</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">        )</span></span>
<span class="line"><span style="color:#9399B2">    ],</span></span>
<span class="line"><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CDD6F4">logger </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> logging</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">getLogger</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">"rich"</span><span style="color:#9399B2">)</span></span></code></pre>
        <p>
          Agora sim, vamos ver o c√≥digo. Deixei v√°rios coment√°rio explicando
          tudo.
        </p>
        <pre
          class="shiki catppuccin-mocha"
          style="background-color: #1e1e2e; color: #cdd6f4"
          tabindex="0"
        ><code><span class="line"><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> argparse</span></span>
<span class="line"><span style="color:#CBA6F7">from</span><span style="color:#CDD6F4"> pathlib </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> Path</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> rich_argparse</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">from</span><span style="color:#CDD6F4"> sussu</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">basic_logger </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> logger</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Example commands:</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># sussu whisper ~/Desktop/videos/part_0004.mp4 --temperature 0 --beam_size 1 \</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># --device cpu --fp16 False --output_format srt --model tiny --language pt \</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># --output_dir ~/Desktop/videos/</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># sussu one ~/Desktop/videos/part_0004.mp4 --temperature 0 --beam_size 1 \</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># --device cpu --fp16 False --output_format srt --model tiny --language pt \</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># --output_dir ~/Desktop/videos/</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">#</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># sussu batch --input_dir ~/Desktop/videos/ --temperature 0 --beam_size 1</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># --device cpu --fp16 False --output_format srt --model tiny --language pt</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># -s video.mp4 part_0000.mp4 --skip_files part_0001.mp4</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># --output_dir 'this wont do anything here'</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Essa fun√ß√£o √© basicamente um jeito de "enganar" o cli do `whisper`</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># para que ele "entenda" que est√° sendo chamado com determinados argumentos.</span></span>
<span class="line"><span style="color:#CBA6F7">def</span><span style="color:#89B4FA;font-style:italic"> whisper_cli_runner</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">whisper_args</span><span style="color:#9399B2">:</span><span style="color:#EBA0AC;font-style:italic"> list</span><span style="color:#9399B2">[</span><span style="color:#CBA6F7;font-style:italic">str</span><span style="color:#9399B2">])</span><span style="color:#9399B2"> -></span><span style="color:#FAB387"> None</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CBA6F7">    import</span><span style="color:#CDD6F4"> sys</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # `whisper` n√£o tem stub, por isso o pyright vai gerar erro (ignorado)</span></span>
<span class="line"><span style="color:#CBA6F7">    from</span><span style="color:#CDD6F4"> whisper</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">transcribe </span><span style="color:#CBA6F7">import</span><span style="color:#CDD6F4"> cli </span><span style="color:#CBA6F7">as</span><span style="color:#CDD6F4"> whisper_cli  </span><span style="color:#9399B2;font-style:italic"># pyright: ignore</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Aqui est√° a mal√≠cia. Vamos fingir que o python est√° recebendo os argumento</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # via sys.argv. Com isso o argparse entra em a√ß√£o da mesma forma que</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # entraria se estivesse sendo executado via linha de comando.</span></span>
<span class="line"><span style="color:#CDD6F4">    sys</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">argv </span><span style="color:#94E2D5">=</span><span style="color:#9399B2"> [</span><span style="color:#A6E3A1">"whisper"</span><span style="color:#9399B2">,</span><span style="color:#94E2D5"> *</span><span style="color:#CDD6F4">whisper_args</span><span style="color:#9399B2">]</span></span>
<span class="line"><span style="color:#89B4FA">    whisper_cli</span><span style="color:#9399B2">()</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic"># Essa √© a nossa fun√ß√£o que vai processar os arquivos usando o whisper original</span></span>
<span class="line"><span style="color:#CBA6F7">def</span><span style="color:#89B4FA;font-style:italic"> batch_whisper</span><span style="color:#9399B2">(</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">    input_dir</span><span style="color:#9399B2">:</span><span style="color:#EBA0AC"> Path</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> whisper_raw_args</span><span style="color:#9399B2">:</span><span style="color:#EBA0AC;font-style:italic"> list</span><span style="color:#9399B2">[</span><span style="color:#CBA6F7;font-style:italic">str</span><span style="color:#9399B2">],</span><span style="color:#EBA0AC;font-style:italic"> skip_files</span><span style="color:#9399B2">:</span><span style="color:#EBA0AC;font-style:italic"> list</span><span style="color:#9399B2">[</span><span style="color:#CBA6F7;font-style:italic">str</span><span style="color:#9399B2">]</span><span style="color:#94E2D5"> |</span><span style="color:#FAB387"> None</span><span style="color:#94E2D5"> =</span><span style="color:#FAB387"> None</span></span>
<span class="line"><span style="color:#9399B2">)</span><span style="color:#9399B2"> -></span><span style="color:#FAB387"> None</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Vamos preencher essa lista com os dados que precisamos</span></span>
<span class="line"><span style="color:#CDD6F4">    whisper_args</span><span style="color:#9399B2">:</span><span style="color:#EBA0AC;font-style:italic"> list</span><span style="color:#9399B2">[</span><span style="color:#CBA6F7;font-style:italic">str</span><span style="color:#9399B2">]</span><span style="color:#94E2D5"> =</span><span style="color:#9399B2"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # As extens√µes abaixo podem n√£o conter todas as extens√µes suportadas pelo</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # ffmpeg, sinta-se √† vontade para adicionar novas extens√µes</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # fmt: off</span></span>
<span class="line"><span style="color:#CDD6F4">    allowed_extensions </span><span style="color:#94E2D5">=</span><span style="color:#9399B2">  {</span></span>
<span class="line"><span style="color:#A6E3A1">        ".mp3"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".wav"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".flac"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".aac"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".m4a"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".ogg"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".opus"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".mp4"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".mkv"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">        ".webm"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".mov"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".avi"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".3gp"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> ".wmv"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">    }</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # fmt: on</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # √Äs vezes tem alguns arquivos na mesma pasta que s√£o v√°lidos, mas n√£o</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # queremos transcrever (eu s√≥ queria agilizar meus testes manuais)</span></span>
<span class="line"><span style="color:#CBA6F7">    if</span><span style="color:#CBA6F7"> not</span><span style="color:#CDD6F4"> skip_files</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">        skip_files </span><span style="color:#94E2D5">=</span><span style="color:#9399B2"> []</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Passamos em todos os arquivos da pasta enviada pelo usu√°rio</span></span>
<span class="line"><span style="color:#CBA6F7">    for</span><span style="color:#CDD6F4"> file </span><span style="color:#CBA6F7">in</span><span style="color:#CDD6F4"> input_dir</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">iterdir</span><span style="color:#9399B2">():</span></span>
<span class="line"><span style="color:#CDD6F4">        skip_loop </span><span style="color:#94E2D5">=</span><span style="color:#FAB387"> False</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        ########## VAMOS PULAR ALGUNS ARQUIVOS PARA EVITAR ERROS ##########</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # Pulamos quando √© um subdiret√≥rio</span></span>
<span class="line"><span style="color:#CBA6F7">        if</span><span style="color:#CDD6F4"> file</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">is_dir</span><span style="color:#9399B2">():</span></span>
<span class="line"><span style="color:#CDD6F4">            logger</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">warning</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1;font-style:italic">f</span><span style="color:#A6E3A1">"Directory not allowed: </span><span style="color:#F5C2E7">{</span><span style="color:#CDD6F4">file</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">name</span><span style="color:#F5C2E7">}</span><span style="color:#A6E3A1">"</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CBA6F7">            continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # Pulamos se a extens√£o n√£o for permitida</span></span>
<span class="line"><span style="color:#CBA6F7">        if</span><span style="color:#CDD6F4"> file</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">suffix </span><span style="color:#CBA6F7">not</span><span style="color:#CBA6F7"> in</span><span style="color:#CDD6F4"> allowed_extensions</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">            logger</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">error</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1;font-style:italic">f</span><span style="color:#A6E3A1">"File extension not allowed: </span><span style="color:#F5C2E7">{</span><span style="color:#CDD6F4">file</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">name</span><span style="color:#F5C2E7">}</span><span style="color:#A6E3A1">"</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CBA6F7">            continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # Pulamos tamb√©m quando o usu√°rio pede para pular aquele arquivo via -s</span></span>
<span class="line"><span style="color:#CBA6F7">        for</span><span style="color:#CDD6F4"> skip_file </span><span style="color:#CBA6F7">in</span><span style="color:#CDD6F4"> skip_files</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CBA6F7">            if</span><span style="color:#CBA6F7;font-style:italic"> str</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">file</span><span style="color:#9399B2">).</span><span style="color:#89B4FA">endswith</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">skip_file</span><span style="color:#9399B2">):</span></span>
<span class="line"><span style="color:#CDD6F4">                logger</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">info</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1;font-style:italic">f</span><span style="color:#A6E3A1">"File skipped: </span><span style="color:#F5C2E7">{</span><span style="color:#CDD6F4">file</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">name</span><span style="color:#F5C2E7">}</span><span style="color:#A6E3A1">"</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">                skip_loop </span><span style="color:#94E2D5">=</span><span style="color:#FAB387"> True</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">        if</span><span style="color:#CDD6F4"> skip_loop</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">            skip_loop </span><span style="color:#94E2D5">=</span><span style="color:#FAB387"> False</span></span>
<span class="line"><span style="color:#CBA6F7">            continue</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        ############ DAQUI EM DIANTE VAI PARA O WHISPER ##########</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # O argumento posicional vai sozinho no primeiro √≠ndice</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # depois os argumentos desconhecidos</span></span>
<span class="line"><span style="color:#CDD6F4">        whisper_args</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">extend</span><span style="color:#9399B2">([</span><span style="color:#CBA6F7;font-style:italic">str</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">file</span><span style="color:#9399B2">),</span><span style="color:#94E2D5"> *</span><span style="color:#CDD6F4">whisper_raw_args</span><span style="color:#9399B2">])</span></span>
<span class="line"><span style="color:#CDD6F4">        logger</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">debug</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1;font-style:italic">f</span><span style="color:#A6E3A1">"audio set as </span><span style="color:#F5C2E7">{</span><span style="color:#CDD6F4">file</span><span style="color:#CBA6F7">!s</span><span style="color:#F5C2E7">}</span><span style="color:#A6E3A1">"</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # Por fim, adicionamos o outdir para ser sempre a pasta onde est√°</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # o arquivo original. Isso gera um arquivo de mesmo nome com a extens√£o</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # `.srt`.</span></span>
<span class="line"><span style="color:#CDD6F4">        logger</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">debug</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1;font-style:italic">f</span><span style="color:#A6E3A1">"--output_dir set to </span><span style="color:#F5C2E7">{</span><span style="color:#CDD6F4">file</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">parent</span><span style="color:#F5C2E7">}</span><span style="color:#A6E3A1">"</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">        whisper_args</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">extend</span><span style="color:#9399B2">([</span><span style="color:#A6E3A1">"--output_dir"</span><span style="color:#9399B2">,</span><span style="color:#CBA6F7;font-style:italic"> str</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">file</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">parent</span><span style="color:#9399B2">)])</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # Desativa o modo verboso do `whisper` por padr√£o para que a gente possa</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # ver nossos logs. Se o user passar algo, usa o que ele passar.</span></span>
<span class="line"><span style="color:#CBA6F7">        if</span><span style="color:#A6E3A1"> "--verbose"</span><span style="color:#CBA6F7"> not</span><span style="color:#CBA6F7"> in</span><span style="color:#CDD6F4"> whisper_args</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">            whisper_args </span><span style="color:#94E2D5">+=</span><span style="color:#9399B2"> [</span><span style="color:#A6E3A1">"--verbose"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "False"</span><span style="color:#9399B2">]</span></span>
<span class="line"><span style="color:#CDD6F4">            logger</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">debug</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">"--verbose set to False by default"</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # Agora s√≥ chamar o whisper com os argumentos que montamos</span></span>
<span class="line"><span style="color:#CDD6F4">        logger</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">debug</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1;font-style:italic">f</span><span style="color:#A6E3A1">"whisper commands are: </span><span style="color:#F5C2E7">{</span><span style="color:#CDD6F4">whisper_args</span><span style="color:#F5C2E7">}</span><span style="color:#A6E3A1">"</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CDD6F4">        logger</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">debug</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1;font-style:italic">f</span><span style="color:#A6E3A1">"Final command: whisper </span><span style="color:#F5C2E7">{</span><span style="color:#A6E3A1">' '</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">join</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">whisper_args</span><span style="color:#9399B2">)</span><span style="color:#F5C2E7">}</span><span style="color:#A6E3A1">"</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#89B4FA">        whisper_cli_runner</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">whisper_args</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # Zeramos os argumentos para o pr√≥ximo loop</span></span>
<span class="line"><span style="color:#CDD6F4">        whisper_args </span><span style="color:#94E2D5">=</span><span style="color:#9399B2"> []</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">def</span><span style="color:#89B4FA;font-style:italic"> build_argparse</span><span style="color:#9399B2">()</span><span style="color:#9399B2"> -></span><span style="color:#CDD6F4"> argparse</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">ArgumentParser</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Nosso main parser e o subparser para os comandos</span></span>
<span class="line"><span style="color:#CDD6F4">    parser </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> argparse</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">ArgumentParser</span><span style="color:#9399B2">(</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        prog</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"sussu"</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> formatter_class</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">rich_argparse</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">RawDescriptionRichHelpFormatter</span></span>
<span class="line"><span style="color:#9399B2">    )</span></span>
<span class="line"><span style="color:#CDD6F4">    subparsers </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> parser</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">add_subparsers</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">dest</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"command"</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> required</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    ########## WHISPER PARSER ##########</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Esse subparse s√≥ ser√° usado como um wrapper do argparse do whisper.</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # No final das contas, ele s√≥ vai chamar `whisper.transcribe.cli()`</span></span>
<span class="line"><span style="color:#CDD6F4">    whisper_parser </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> subparsers</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">add_parser</span><span style="color:#9399B2">(</span></span>
<span class="line"><span style="color:#A6E3A1">        "whisper"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        help</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"Calls `whisper` directly"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        conflict_handler</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"resolve"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        aliases</span><span style="color:#94E2D5">=</span><span style="color:#9399B2">[</span><span style="color:#A6E3A1">"one"</span><span style="color:#9399B2">],</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        formatter_class</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">rich_argparse</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">RawDescriptionRichHelpFormatter</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">    )</span></span>
<span class="line"><span style="color:#CDD6F4">    whisper_parser</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">set_defaults</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">command</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"whisper"</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Esse argumento aqui √© pra garantir que vamos chamar o help do whisper e</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # n√£o do nosso parser</span></span>
<span class="line"><span style="color:#CDD6F4">    whisper_parser</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">add_argument</span><span style="color:#9399B2">(</span></span>
<span class="line"><span style="color:#A6E3A1">        "-h"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "--help"</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> help</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"Shows `whisper` help."</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> action</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"store_true"</span></span>
<span class="line"><span style="color:#9399B2">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    ########## NOSSOS PARSERS ##########</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Minha ideia aqui √© criar um subparser `batch` que vai receber um diret√≥rio</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # com arquivos de v√≠deo. Vamos passar em todos os arquivos do diret√≥rio e</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # usar o whisper para transcrever cada um deles.</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CDD6F4">    batch_parser </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> subparsers</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">add_parser</span><span style="color:#9399B2">(</span></span>
<span class="line"><span style="color:#A6E3A1">        "batch"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        help</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"Process files with `whisper` in batch mode"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        formatter_class</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">rich_argparse</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">RawDescriptionRichHelpFormatter</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # S√≥ coloquei essa fun√ß√£o aqui para ficar pr√≥xima do argumento e facilitar</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # minha explica√ß√£o na hora de gravar.</span></span>
<span class="line"><span style="color:#CBA6F7">    def</span><span style="color:#89B4FA;font-style:italic"> parse_input_dir</span><span style="color:#9399B2">(</span><span style="color:#EBA0AC;font-style:italic">path_str</span><span style="color:#9399B2">:</span><span style="color:#CBA6F7;font-style:italic"> str</span><span style="color:#9399B2">)</span><span style="color:#9399B2"> -></span><span style="color:#CDD6F4"> Path</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#CDD6F4">        path </span><span style="color:#94E2D5">=</span><span style="color:#89B4FA"> Path</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">path_str</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">        if</span><span style="color:#CBA6F7"> not</span><span style="color:#CDD6F4"> path</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">is_dir</span><span style="color:#9399B2">():</span></span>
<span class="line"><span style="color:#CDD6F4">            msg </span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1;font-style:italic"> f</span><span style="color:#A6E3A1">"</span><span style="color:#F5C2E7">{</span><span style="color:#CDD6F4">path_str</span><span style="color:#CBA6F7">!r</span><span style="color:#F5C2E7">}</span><span style="color:#A6E3A1"> is not a directory"</span></span>
<span class="line"><span style="color:#CBA6F7">            raise</span><span style="color:#CDD6F4"> argparse</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">ArgumentTypeError</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">msg</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">        return</span><span style="color:#CDD6F4"> path</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">resolve</span><span style="color:#9399B2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Isso dever√° ser uma pasta que cont√©m arquivos de v√≠deo ou √°udio</span></span>
<span class="line"><span style="color:#CDD6F4">    batch_parser</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">add_argument</span><span style="color:#9399B2">(</span></span>
<span class="line"><span style="color:#A6E3A1">        "--input_dir"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        help</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"Directory with files to work with"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        type</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">parse_input_dir</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        required</span><span style="color:#94E2D5">=</span><span style="color:#FAB387">True</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#9399B2">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Para testar, eu estava pulando um monte de arquivos para ir mais r√°pido</span></span>
<span class="line"><span style="color:#CDD6F4">    batch_parser</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">add_argument</span><span style="color:#9399B2">(</span></span>
<span class="line"><span style="color:#A6E3A1">        "-s"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#A6E3A1">        "--skip_files"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        help</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"Name of file(s) to skip"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        action</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"extend"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        nargs</span><span style="color:#94E2D5">=</span><span style="color:#A6E3A1">"+"</span><span style="color:#9399B2">,</span></span>
<span class="line"><span style="color:#EBA0AC;font-style:italic">        default</span><span style="color:#94E2D5">=</span><span style="color:#9399B2">[],</span></span>
<span class="line"><span style="color:#9399B2">    )</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Essa foi a maneira mais simples e direta de remover output_dir dos</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # unknown_args. Se isso fosse para o whisper, geraria conflito</span></span>
<span class="line"><span style="color:#CDD6F4">    batch_parser</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">add_argument</span><span style="color:#9399B2">(</span><span style="color:#A6E3A1">"-o"</span><span style="color:#9399B2">,</span><span style="color:#A6E3A1"> "--output_dir"</span><span style="color:#9399B2">,</span><span style="color:#EBA0AC;font-style:italic"> help</span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4">argparse</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">SUPPRESS</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CBA6F7">    return</span><span style="color:#CDD6F4"> parser</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">def</span><span style="color:#89B4FA;font-style:italic"> run</span><span style="color:#9399B2">()</span><span style="color:#9399B2"> -></span><span style="color:#FAB387"> None</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    ########## PARSE KNOWN ARGS ##########</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Vamos receber argumentos que s√£o conhecidos (os nossos), e desconhecidos.</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Argumentos desconhecidos ser√£o repassados para o whisper cli.</span></span>
<span class="line"><span style="color:#CDD6F4">    parser </span><span style="color:#94E2D5">=</span><span style="color:#89B4FA"> build_argparse</span><span style="color:#9399B2">()</span></span>
<span class="line"><span style="color:#CDD6F4">    args</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> unknown_args </span><span style="color:#94E2D5">=</span><span style="color:#CDD6F4"> parser</span><span style="color:#9399B2">.</span><span style="color:#89B4FA">parse_known_args</span><span style="color:#9399B2">()</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Se o comando for whisper, passamos tudo direto para o whisper</span></span>
<span class="line"><span style="color:#CBA6F7">    if</span><span style="color:#CDD6F4"> args</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">command </span><span style="color:#94E2D5">==</span><span style="color:#A6E3A1"> "whisper"</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # Simula -h e --help</span></span>
<span class="line"><span style="color:#CBA6F7">        if</span><span style="color:#CDD6F4"> args</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">help</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#89B4FA">            whisper_cli_runner</span><span style="color:#9399B2">([</span><span style="color:#A6E3A1">"--help"</span><span style="color:#9399B2">])</span></span>
<span class="line"><span style="color:#CBA6F7">            return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # Executa o whisper normal, s√≥ que por baixo de `sussu`</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # Ex.: `sussu whisper audio.mp3` chama o cli original do `whisper` com</span></span>
<span class="line"><span style="color:#9399B2;font-style:italic">        # o argumento `audio.mp3` (ou qualquer outro argumento)</span></span>
<span class="line"><span style="color:#89B4FA">        whisper_cli_runner</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">unknown_args</span><span style="color:#9399B2">)</span></span>
<span class="line"><span style="color:#CBA6F7">        return</span></span>
<span class="line"></span>
<span class="line"><span style="color:#9399B2;font-style:italic">    # Se o comando for `batch`, fazemos nosso trabalho</span></span>
<span class="line"><span style="color:#CBA6F7">    if</span><span style="color:#CDD6F4"> args</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">command </span><span style="color:#94E2D5">==</span><span style="color:#A6E3A1"> "batch"</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#89B4FA">        batch_whisper</span><span style="color:#9399B2">(</span><span style="color:#CDD6F4">args</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">input_dir</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> unknown_args</span><span style="color:#9399B2">,</span><span style="color:#CDD6F4"> args</span><span style="color:#9399B2">.</span><span style="color:#CDD6F4">skip_files</span><span style="color:#9399B2">)</span></span>
<span class="line"></span>
<span class="line"></span>
<span class="line"><span style="color:#CBA6F7">if</span><span style="color:#CDD6F4"> __name__ </span><span style="color:#94E2D5">==</span><span style="color:#A6E3A1"> "__main__"</span><span style="color:#9399B2">:</span></span>
<span class="line"><span style="color:#89B4FA">    run</span><span style="color:#9399B2">()</span></span></code></pre>
        <p>√â s√≥ isso! Obrigado por ler.</p>
        <hr />
      </article>

      <footer class="nav">
        <a class="copyright-link" href="/">Ot√°vio Miranda</a>
        <a
          target="_blank"
          href="https://beacons.ai/otaviomiranda"
          rel="nofollow noopener noreferrer"
          >Contatos</a
        >
      </footer>
    </main>

    <script defer src="../../js/scripts_2026.js"></script>
  </body>
</html>
