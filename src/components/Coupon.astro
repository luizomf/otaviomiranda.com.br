---
/**
 * ARQUIVO: Coupon.astro
 *
 * O QUE FAZ:
 *   Secao de cupom de desconto. Exibe um codigo promocional (ex.:
 *   "OTAVIO") dentro de um card com efeito glassmorphism (.glass)
 *   e uma label de validade. Os valores padrao vem da configuracao
 *   centralizada HOME_COUPON (src/config/coupon), mas podem ser
 *   sobrescritos via props (code, expiresAtLabel).
 *
 * USADO EM:
 *   - src/pages/index.astro
 *
 * CONCEITO ASTRO:
 *   - Props com valores padrao: desestruturacao com fallback
 *     (code = HOME_COUPON.code) permite que o componente funcione
 *     sem que o consumidor passe nenhuma prop.
 *   - Importacao de dados de configuracao (../config/coupon) no
 *     frontmatter: como o Astro roda no servidor/build, qualquer
 *     modulo JS/TS pode ser importado e usado para gerar HTML
 *     estatico.
 *   - O <style> scoped estiliza .coupon com pseudo-elemento
 *     ::after para o efeito de "brilho" deslizante no hover,
 *     similar ao de ColorfulBorder mas implementado localmente.
 *   - theme='dark' e class='bg-parallax' sao passados para o
 *     componente <Section>, demonstrando como props fluem entre
 *     componentes Astro na arvore de composicao.
 */
import Section from './Section.astro';
import SectionHeader from './SectionHeader.astro';
import { HOME_COUPON } from '../config/coupon';

interface Props {
  code?: string;
  expiresAtLabel?: string;
}

const { code = HOME_COUPON.code, expiresAtLabel = HOME_COUPON.expiresAtLabel } =
  Astro.props as Props;
---

<Section
  id='coupon'
  theme='dark'
  class='bg-parallax'
  contentClass='section-coupon'
>
  <SectionHeader
    eyeball='Para você'
    title='Desconto exclusivo'
    description='Leve sua carreira de desenvolvedor para o próximo nível pagando menos. Use o cupom abaixo e tenha acesso vitalício.'
  >
    <div class='discount-container'>
      <div class='coupon glass'>{code}</div>
      <div class='coupon-date'>{expiresAtLabel}</div>
    </div>
  </SectionHeader>
</Section>

<style>
  .discount-container {
    margin-top: var(--spacings-lg-100);
    display: flex;
    flex-direction: column;
    align-items: center;
  }

  .coupon {
    padding: var(--spacings-sm-600) var(--spacings-lg-200);
    margin-bottom: var(--spacings-lg-200);
    border-radius: var(--border-radius-me);
    font-weight: 900;
    font-size: clamp(var(--font-size-h-xsm), 4vw, var(--font-size-h-xxlg));
    font-family: var(--font-mono);
    letter-spacing: 0.05em;

    &::after {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      z-index: 3;
      background: linear-gradient(
        -45deg,
        transparent 10%,
        rgba(255, 255, 255, 0.2) 50%,
        transparent 90%
      );
      transition: left 600ms ease;
    }

    &:hover::after {
      left: 100%;
    }
  }

  .coupon-date {
    padding: var(--spacings-sm-200) 0;
    font-size: var(--font-size-xxsm);
    color: hsl(from var(--main-clr-shade) h s 60% / 1);
    text-transform: uppercase;
    letter-spacing: 0.05em;
  }
</style>
